#esp32/publisher.py


from umqtt.simple import MQTTClient
import time

from project import d


SERVER = '149.28.147.236'
CLIENT_ID = 'esp8266 - A' # 客户端的ID
TOPIC1 = b'temperature' # TOPIC的ID
TOPIC2 = b'humidity' # TOPIC的ID



client = MQTTClient(CLIENT_ID, SERVER)
client.connect()


while True:
    d.measure()
    temp = d.temperature()
    hum = d.humidity()
    print(temp,hum)
    
    
    client.publish(TOPIC2, str(hum))
    client.publish(TOPIC1, str(temp))


    print('publised @ ',time.time())
    time.sleep(5)

